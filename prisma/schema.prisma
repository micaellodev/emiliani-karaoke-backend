// This is your Prisma schema file

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum UserRole {
  OWNER
  WORKER
}

enum QueueStatus {
  PENDING
  APPROVED
  PLAYING
  FINISHED
  REJECTED
}

model User {
  id            String   @id @default(cuid())
  username      String   @unique
  password      String   // Hashed with bcrypt
  role          UserRole @default(WORKER)
  createdAt     DateTime @default(now()) @map("created_at")
  updatedAt     DateTime @updatedAt @map("updated_at")

  @@map("users")
}

model QueueItem {
  id              String      @id @default(cuid())
  youtubeId       String      @map("youtube_id")
  title           String
  channelTitle    String      @map("channel_title")
  duration        String
  requestedByTable Int        @map("requested_by_table")
  requestedBy      String?    @map("requested_by")
  status          QueueStatus @default(PENDING)
  order           Int         @default(0)
  createdAt       DateTime    @default(now()) @map("created_at")
  playedAt        DateTime?   @map("played_at")

  @@index([status, order])
  @@map("queue_items")
}

model TableSession {
  id          Int      @id @default(autoincrement())
  tableNumber Int      @unique @map("table_number")
  userName    String   @map("user_name")
  createdAt   DateTime @default(now()) @map("created_at")

  @@map("table_sessions")
}

model Settings {
  id            String   @id @default(cuid())
  venueName     String   @default("Karaoke Venue") @map("venue_name")
  isSystemLocked Boolean @default(false) @map("is_system_locked")
  createdAt     DateTime @default(now()) @map("created_at")
  updatedAt     DateTime @updatedAt @map("updated_at")

  @@map("settings")
}
